Part 1: Installing Packages

```{r eval=FALSE, include=TRUE}
install.packages("quantmod")
library(quantmod)
```

Part 2: Retrieving data using Quantmod for Japanese stocks

```{r eval=FALSE, include=TRUE}
startJP <- as.Date("2018-05-09")
endJP <- as.Date("2018-09-09")

symbolBasketJP <- c("6113.T", "3865.T", "7211.T", "9735.T", "3289.T")

getSymbols(symbolBasketJP , src='yahoo', from = startJP, to = endJP)

Amada <- as.xts(`6113.T`)
names(Amada) <- c("Amada.Open"   ,  "Amada.High"   ,  "Amada.Low"   ,   "Amada.Close"  , "Amada.Volume",  "Amada.Adjusted")

Hokuetsu <- as.xts(`3865.T`)
names(Hokuetsu) <- c("Hokuetsu.Open"   ,  "Hokuetsu.High"   ,  "Hokuetsu.Low"   ,   "Hokuetsu.Close"  ,  "Hokuetsu.Volume",  "Hokuetsu.Adjusted")

Mitsubishi <- as.xts(`7211.T`)
names(Mitsubishi) <- c("Mitsubishi.Open"   ,  "Mitsubishi.High"   ,  "Mitsubishi.Low"   ,   "Mitsubishi.Close"  ,  "Mitsubishi.Volume",  "Mitsubishi.Adjusted")

Secom <- as.xts(`9735.T`)
names(Secom) <- c("Secom.Open"   ,  "Secom.High"   ,  "Secom.Low"   ,   "Secom.Close"  ,  "Secom.Volume",  "Secom.Adjusted")

Tokyu <- as.xts(`3289.T`)
names(Tokyu) <- c("Tokyu.Open"   ,  "Tokyu.High"   ,  "Tokyu.Low"   ,   "Tokyu.Close"  ,  "Tokyu.Volume",  "Tokyu.Adjusted")
```

Part 3: Retrieving data using Quantmod for Indian stocks

```{r eval=FALSE, include=TRUE}
startIN <- as.Date("2018-06-18")
endIN <- as.Date("2018-10-18")

symbolBasketIN <- c("TATASTEEL.BO", "TECHM.BO", "BAJAJ-AUTO.BO", "ICICIBANK.BO", "LT.BO")

getSymbols(symbolBasketIN, src='yahoo', from = startJP, to = endJP)

Tata <- as.xts(`TATASTEEL.BO`)
names(Tata) <- c("Tata.Open"   ,  "Tata.High"   ,  "Tata.Low"   ,   "Tata.Close"  ,  "Tata.Volume",  "Tata.Adjusted")

Mahindra <- as.xts(`TECHM.BO`)
names(Mahindra) <- c("Mahindra.Open"   ,  "Mahindra.High"   ,  "Mahindra.Low"   ,   "Mahindra.Close"  ,  "Mahindra.Volume",  "Mahindra.Adjusted")

Bajaj <- as.xts(`BAJAJ-AUTO.BO`)
names(Bajaj) <- c("Bajaj.Open"   ,  "Bajaj.High"   ,  "Bajaj.Low"   ,   "Bajaj.Close"  ,  "Bajaj.Volume",  "Bajaj.Adjusted")

ICICI <- as.xts(`ICICIBANK.BO`)
names(ICICI) <- c("ICICI.Open"   ,  "ICICI.High"   ,  "ICICI.Low"   ,   "ICICI.Close"  ,  "ICICI.Volume",  "ICICI.Adjusted")

LT <- as.xts(`LT.BO`)
names(LT) <- c("LT.Open"   ,  "LT.High"   ,  "LT.Low"   ,   "LT.Close"  ,  "LT.Volume",  "LT.Adjusted")
```

Estimation Period JP: From 9th May to 29th June

Event Window JP: From 2nd July to 7th September


Estimation Period IN: From 18th June to 8th August

Event Window IN: From 9th August to 17th October

Part 4: Market data and risk-free

```{r eval=FALSE, include=TRUE}
JPMKT <- read.csv("JP MKT.csv")
JPRF <- read.csv("JP RF.csv")

JPMKT$Return <- (JPMKT$Close-JPMKT$Open)/JPMKT$Open
JPRF$Return <- (JPRF$Close-JPRF$Open)/JPRF$Open

JPMKT.EP<- JPMKT[1:38,] #Creating a subset for our Estimation Period
JPMKT.EW<- JPMKT[39:88,] #Creating a subset for our Event Window

JPRF.EP<- JPRF[1:38,] #Creating a subset for our Estimation Period
JPRF.EW<- JPRF[39:88,] #Creating a subset for our Event Window

INMKT <- read.csv("IN MKT.csv")
INRF <- read.csv("IN RF.csv")

INMKT$Return <- (INMKT$Close-INMKT$Open)/INMKT$Open

INMKT.EP<- INMKT[1:38,] #Creating a subset for our Estimation Period
INMKT.EW<- INMKT[39:83,] #Creating a subset for our Event Window

INRF.EP<- INRF[1:38,] #Creating a subset for our Estimation Period
INRF.EW<- INRF[39:83,] #Creating a subset for our Event Window
```

Part 5: Cumulative Abnormal Return (CAR) Calculations for Japanese Stocks

Sub-part a: Amada CAR
```{r eval=FALSE, include=TRUE}
#Calculate Daily Return
Amada$Amada.Return <- (Amada$Amada.Close-Amada$Amada.Open)/Amada$Amada.Open
plot(Amada$Amada.Return)
hist(Amada$Amada.Return)
```

```{r eval=FALSE, include=TRUE}
#Subsets
Amada.EP <- Amada[1:38,] #Creating a subset for our Estimation Period
Amada.EW<- Amada[39:88,] #Creating a subset for our Event Window

#Use the Estimation Period to calculate alpha and beta 
Amada.EP$Amada.MRP <- JPMKT.EP$Return - JPRF.EP$Return #Market Risk Premium
Amada.EP$Amada.SRP <- Amada.EP$Amada.Return - JPRF.EP$Return #Stock Risk Premium

r1<- glm(Amada.EP$Amada.SRP~ Amada.EP$Amada.MRP) 
summary(r1)

alphaAmada <- -0.003608 #(p value=0.00333, thus significant at the 1% level)
betaAmada <- 0.977012

#Calculate the Abnormal Revenue in the Event Window 
Amada.EW$Amada.AR <- Amada.EW$Amada.Return - (JPRF.EW$Return -alphaAmada + betaAmada*(JPMKT.EW$Return - JPRF.EW$Return))
Amada.CAR <- cumsum(Amada.EW$Amada.AR)

Amada.EW$Amada.DateNum <- 1:nrow(Amada.EW)
```

```{r eval=FALSE, include=TRUE}
#Plot CAR 
candleChart(Amada.CAR)
```

Sub-part b: Hokuetsu CAR
```{r eval=FALSE, include=TRUE}
#Calculate Daily Return
Hokuetsu$Hokuetsu.Return <- (Hokuetsu$Hokuetsu.Close-Hokuetsu$Hokuetsu.Open)/Hokuetsu$Hokuetsu.Open
plot(Hokuetsu$Hokuetsu.Return)
hist(Hokuetsu$Hokuetsu.Return)
```

```{r eval=FALSE, include=TRUE}
#Subsets
Hokuetsu.EP <- Hokuetsu[1:38,] #Creating a subset for our Estimation Period
Hokuetsu.EW<- Hokuetsu[39:88,] #Creating a subset for our Event Window

#Use the Estimation Period to calculate alpha and beta 
Hokuetsu.EP$Hokuetsu.MRP <- JPMKT.EP$Return - JPRF.EP$Return #Market Risk Premium
Hokuetsu.EP$Hokuetsu.SRP <- Hokuetsu.EP$Hokuetsu.Return - JPRF.EP$Return #Stock Risk Premium

r2<- glm(Hokuetsu.EP$Hokuetsu.SRP~ Hokuetsu.EP$Hokuetsu.MRP) 
summary(r2)

alphaHokuetsu <- -0.003291 #(p value=0.14366, thus NOT significant at the 1% level)
betaHokuetsu <- 0.703316

#Calculate the Abnormal Revenue in the Event Window 
Hokuetsu.EW$Hokuetsu.AR <- Hokuetsu.EW$Hokuetsu.Return - (JPRF.EW$Return - alphaHokuetsu + betaHokuetsu*(JPMKT.EW$Return - JPRF.EW$Return))
Hokuetsu.CAR <- cumsum(Hokuetsu.EW$Hokuetsu.AR)

Hokuetsu.EW$Hokuetsu.DateNum <- 1:nrow(Hokuetsu.EW)
```

```{r eval=FALSE, include=TRUE}
#Plot CAR 
plot(Hokuetsu.CAR)
```

Sub-part c: Mitsubishi CAR
```{r eval=FALSE, include=TRUE}
#Calculate Daily Return
Mitsubishi$Mitsubishi.Return <- (Mitsubishi$Mitsubishi.Close-Mitsubishi$Mitsubishi.Open)/Mitsubishi$Mitsubishi.Open
plot(Mitsubishi$Mitsubishi.Return)
hist(Mitsubishi$Mitsubishi.Return)
```

```{r eval=FALSE, include=TRUE}
#Subsets
Mitsubishi.EP <- Mitsubishi[1:38,] #Creating a subset for our Estimation Period
Mitsubishi.EW<- Mitsubishi[39:88,] #Creating a subset for our Event Window

#Use the Estimation Period to calculate alpha and beta 
Mitsubishi.EP$Mitsubishi.MRP <- JPMKT.EP$Return - JPRF.EP$Return #Market Risk Premium
Mitsubishi.EP$Mitsubishi.SRP <- Mitsubishi.EP$Mitsubishi.Return - JPRF.EP$Return #Stock Risk Premium

r3<- glm(Mitsubishi.EP$Mitsubishi.SRP~ Mitsubishi.EP$Mitsubishi.MRP) 
summary(r3)

alphaMitsubishi <- 0.002284 #(p value=0.272893, thus significant NOT at the 1% level)
betaMitsubishi <- 0.801695

#Calculate the Abnormal Revenue in the Event Window 
Mitsubishi.EW$Mitsubishi.AR <- Mitsubishi.EW$Mitsubishi.Return - (JPRF.EW$Return - alphaMitsubishi + betaMitsubishi*(JPMKT.EW$Return - JPRF.EW$Return))
Mitsubishi.CAR <- cumsum(Mitsubishi.EW$Mitsubishi.AR)

Mitsubishi.EW$Mitsubishi.DateNum <- 1:nrow(Mitsubishi.EW)
```

```{r eval=FALSE, include=TRUE}
#Plot CAR 
plot(Mitsubishi.CAR)
```

Sub-part d: Secom CAR
```{r eval=FALSE, include=TRUE}
#Calculate Daily Return
Secom$Secom.Return <- (Secom$Secom.Close-Secom$Secom.Open)/Secom$Secom.Open
plot(Secom$Secom.Return)
hist(Secom$Secom.Return)
```

```{r eval=FALSE, include=TRUE}
#Subsets
Secom.EP <- Secom[1:38,] #Creating a subset for our Estimation Period
Secom.EW<- Secom[39:88,] #Creating a subset for our Event Window

#Use the Estimation Period to calculate alpha and beta 
Secom.EP$Secom.MRP <- JPMKT.EP$Return - JPRF.EP$Return #Market Risk Premium
Secom.EP$Secom.SRP <- Secom.EP$Secom.Return - JPRF.EP$Return #Stock Risk Premium

r4<- glm(Secom.EP$Secom.SRP~ Secom.EP$Secom.MRP) 
summary(r4)

alphaSecom <- -0.0003572 #(p value=0.748, thus significant NOT at the 1% level)
betaSecom <- 0.8365680

#Calculate the Abnormal Revenue in the Event Window 
Secom.EW$Secom.AR <- Secom.EW$Secom.Return - (JPRF.EW$Return - alphaSecom + betaSecom*(JPMKT.EW$Return - JPRF.EW$Return))
Secom.CAR <- cumsum(Secom.EW$Secom.AR)

Secom.EW$Secom.DateNum <- 1:nrow(Secom.EW)
```

```{r eval=FALSE, include=TRUE}
#Plot CAR 
plot(Secom.CAR)
```

Sub-part e: Tokyu CAR
```{r eval=FALSE, include=TRUE}
#Calculate Daily Return
Tokyu$Tokyu.Return <- (Tokyu$Tokyu.Close-Tokyu$Tokyu.Open)/Tokyu$Tokyu.Open
plot(Tokyu$Tokyu.Return)
hist(Tokyu$Tokyu.Return)
```

```{r eval=FALSE, include=TRUE}
#Subset
Tokyu.EP <- Tokyu[1:38,] #Creating a subset for our Estimation Period
Tokyu.EW<- Tokyu[39:88,] #Creating a subset for our Event Window

#Use the Estimation Period to calculate alpha and beta 
Tokyu.EP$Tokyu.MRP <- JPMKT.EP$Return - JPRF.EP$Return #Market Risk Premium
Tokyu.EP$Tokyu.SRP <- Tokyu.EP$Tokyu.Return - JPRF.EP$Return #Stock Risk Premium

r5<- glm(Tokyu.EP$Tokyu.SRP~ Tokyu.EP$Tokyu.MRP) 
summary(r5)

alphaTokyu <- -0.001188 #(p value=0.479, thus NOT significant at the 1% level)
betaTokyu <- 0.932754

#Calculate the Abnormal Revenue in the Event Window 
Tokyu.EW$Tokyu.AR <- Tokyu.EW$Tokyu.Return - (JPRF.EW$Return - alphaTokyu + betaTokyu*(JPMKT.EW$Return - JPRF.EW$Return))
Tokyu.CAR <- cumsum(Tokyu.EW$Tokyu.AR)

Tokyu.EW$Tokyu.DateNum <- 1:nrow(Tokyu.EW)
```

```{r eval=FALSE, include=TRUE}
#Plot CAR 
plot(Tokyu.CAR)
```

Part 6: Cumulative Abnormal Return (CAR) Calculations for Indian Stocks

Sub-part a: Tata CAR
```{r eval=FALSE, include=TRUE}
#Calculate Daily Return
Tata$Tata.Return <- (Tata$Tata.Close-Tata$Tata.Open)/Tata$Tata.Open
plot(Tata$Tata.Return)
hist(Tata$Tata.Return)
```

```{r eval=FALSE, include=TRUE}
Tata.EP <- Tata[1:38,] #Creating a subset for our Estimation Period
Tata.EW<- Tata[39:83,] #Creating a subset for our Event Window

#Use the Estimation Period to calculate alpha and beta 
Tata.EP$Tata.MRP <- INMKT.EP$Return - INRF.EP$Return #Market Risk Premium
Tata.EP$Tata.SRP <- Tata.EP$Tata.Return - INRF.EP$Return #Stock Risk Premium

r6<- glm(Tata.EP$Tata.SRP~ Tata.EP$Tata.MRP) 
summary(r6)

alphaTata <- -0.002148 #(p value=0.49185, thus NOT significant at the 1% level)
betaTata <- 1.426842

#Calculate the Abnormal Revenue in the Event Window 
Tata.EW$Tata.AR <- Tata.EW$Tata.Return - (INRF.EW$Return - alphaTata + betaTata*(INMKT.EW$Return - INRF.EW$Return))
Tata.CAR <- cumsum(Tata.EW$Tata.AR)

Tata.EW$Tata.DateNum <- 1:nrow(Tata.EW)
```

```{r eval=FALSE, include=TRUE}
#Plot CAR 
plot(Tata.CAR)
```

Sub-part b: Mahindra CAR
```{r eval=FALSE, include=TRUE}
#Calculate Daily Return
Mahindra$Mahindra.Return <- (Mahindra$Mahindra.Close-Mahindra$Mahindra.Open)/Mahindra$Mahindra.Open
plot(Mahindra$Mahindra.Return)
hist(Mahindra$Mahindra.Return)
```

```{r eval=FALSE, include=TRUE}
Mahindra.EP <- Mahindra[1:38,] #Creating a subset for our Estimation Period
Mahindra.EW<- Mahindra[39:83,] #Creating a subset for our Event Window

#Use the Estimation Period to calculate alpha and beta 
Mahindra.EP$Mahindra.MRP <- INMKT.EP$Return - INRF.EP$Return #Market Risk Premium
Mahindra.EP$Mahindra.SRP <- Mahindra.EP$Mahindra.Return - INRF.EP$Return #Stock Risk Premium

r7<- glm(Mahindra.EP$Mahindra.SRP~ Mahindra.EP$Mahindra.MRP) 
summary(r7)

alphaMahindra <- -0.002102 #(p value=0.545, thus NOT significant at the 1% level)
betaMahindra <- 0.618476

#Calculate the Abnormal Revenue in the Event Window 
Mahindra.EW$Mahindra.AR <- Mahindra.EW$Mahindra.Return - (INRF.EW$Return - alphaMahindra + betaMahindra*(INMKT.EW$Return - INRF.EW$Return))
Mahindra.CAR <- cumsum(Mahindra.EW$Mahindra.AR)

Mahindra.EW$Mahindra.DateNum <- 1:nrow(Mahindra.EW)
```

```{r eval=FALSE, include=TRUE}
#Plot CAR 
plot(Mahindra.CAR)
```

Sub-part c: Bajaj CAR
```{r eval=FALSE, include=TRUE}
#Calculate Daily Return
Bajaj$Bajaj.Return <- (Bajaj$Bajaj.Close-Bajaj$Bajaj.Open)/Bajaj$Bajaj.Open
plot(Bajaj$Bajaj.Return)
hist(Bajaj$Bajaj.Return)
```

```{r eval=FALSE, include=TRUE}
Bajaj.EP <- Bajaj[1:38,] #Creating a subset for our Estimation Period
Bajaj.EW<- Bajaj[39:83,] #Creating a subset for our Event Window

#Use the Estimation Period to calculate alpha and beta 
Bajaj.EP$Bajaj.MRP <- INMKT.EP$Return - INRF.EP$Return #Market Risk Premium
Bajaj.EP$Bajaj.SRP <- Bajaj.EP$Bajaj.Return - INRF.EP$Return #Stock Risk Premium

r8<- glm(Bajaj.EP$Bajaj.SRP~ Bajaj.EP$Bajaj.MRP) 
summary(r8)

alphaBajaj <- -0.004249 #(p value=0.06590, thus NOT significant at the 1% level)
betaBajaj <- 0.970810

#Calculate the Abnormal Revenue in the Event Window 
Bajaj.EW$Bajaj.AR <- Bajaj.EW$Bajaj.Return - (INRF.EW$Return - alphaBajaj + betaBajaj*(INMKT.EW$Return - INRF.EW$Return))
Bajaj.CAR <- cumsum(Bajaj.EW$Bajaj.AR)

Bajaj.EW$Bajaj.DateNum <- 1:nrow(Bajaj.EW)
```

```{r eval=FALSE, include=TRUE}
#Plot CAR 
plot(Bajaj.CAR)
```

Sub-part d: ICICI CAR
```{r eval=FALSE, include=TRUE}
#Calculate Daily Return
ICICI$ICICI.Return <- (ICICI$ICICI.Close-ICICI$ICICI.Open)/ICICI$ICICI.Open
plot(ICICI$ICICI.Return)
hist(ICICI$ICICI.Return)
```

```{r eval=FALSE, include=TRUE}
ICICI.EP <- ICICI[1:38,] #Creating a subset for our Estimation Period
ICICI.EW<- ICICI[39:83,] #Creating a subset for our Event Window

#Use the Estimation Period to calculate alpha and beta 
ICICI.EP$ICICI.MRP <- INMKT.EP$Return - INRF.EP$Return #Market Risk Premium
ICICI.EP$ICICI.SRP <- ICICI.EP$ICICI.Return - INRF.EP$Return #Stock Risk Premium

r9<- glm(ICICI.EP$ICICI.SRP~ ICICI.EP$ICICI.MRP) 
summary(r9)

alphaICICI <- -0.003624 #(p value=0.15029, thus NOT significant at the 1% level)
betaICICI <- 0.993554

#Calculate the Abnormal Revenue in the Event Window 
ICICI.EW$ICICI.AR <- ICICI.EW$ICICI.Return - (INRF.EW$Return - alphaICICI + betaICICI*(INMKT.EW$Return - INRF.EW$Return))
ICICI.CAR <- cumsum(ICICI.EW$ICICI.AR)

ICICI.EW$ICICI.DateNum <- 1:nrow(ICICI.EW)
```

```{r eval=FALSE, include=TRUE}
#Plot CAR 
plot(ICICI.CAR)
```

Sub-part e: LT CAR
```{r eval=FALSE, include=TRUE}
#Calculate Daily Return
LT$LT.Return <- (LT$LT.Close-LT$LT.Open)/LT$LT.Open
plot(LT$LT.Return)
hist(LT$LT.Return)
```

```{r eval=FALSE, include=TRUE}
LT.EP <- LT[1:38,] #Creating a subset for our Estimation Period
LT.EW<- LT[39:83,] #Creating a subset for our Event Window

#Use the Estimation Period to calculate alpha and beta 
LT.EP$LT.MRP <- INMKT.EP$Return - INRF.EP$Return #Market Risk Premium
LT.EP$LT.SRP <- LT.EP$LT.Return - INRF.EP$Return #Stock Risk Premium

r10<- glm(LT.EP$LT.SRP~ LT.EP$LT.MRP) 
summary(r10)

alphaLT <- -0.002067 #(p value=0.3170, thus NOT significant at the 1% level)
betaLT <- 0.707289

#Calculate the Abnormal Revenue in the Event Window 
LT.EW$LT.AR <- LT.EW$LT.Return - (INRF.EW$Return - alphaLT + betaLT*(INMKT.EW$Return - INRF.EW$Return))
LT.CAR <- cumsum(LT.EW$LT.AR)

LT.EW$LT.DateNum <- 1:nrow(LT.EW)
```

```{r eval=FALSE, include=TRUE}
#Plot CAR 
plot(LT.CAR)
```

Part 7: Regression Trees 